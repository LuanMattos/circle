<div class="container-photo-form">
  <form class="pb-4" [formGroup]="photoForm" (submit)="getImageCropped()">
    <div>
      <div class="row">
        <div class="col-auto w-50">
            <input type="checkbox" [checked]="allowComments" class="hide">
            <input type="checkbox" [checked]="public" class="hide">
        </div>
      </div>
      <div class="row">
        <div class="col-auto">
          <img [src]="avatar" class="avatar rounded-circle" onerror="this.src='https://be.mycircle.click/storage/profile_default/default.png'">
        </div>
        <div class="col-auto">
          <div class="mt-2 menu-options-public" (click)="public = !public">
            <span class="ml-2">Public</span>
            <i class="m-1 fa fa-globe {{public?'text-primary':'text-black'}}" aria-hidden="true" title="Público"></i>
          </div>
        </div>
        <div class="col-auto">
          <div class="mt-2 menu-options-public" (click)="allowComments = !allowComments">
            <span class="ml-1">Comment</span>
            <i class="m-1 fa fa-comments-o {{allowComments?'text-primary':'text-black'}}" aria-hidden="true"
               title="Ativar comentários"></i>
          </div>
        </div>
      </div>
      <div class="row w-100 m-auto">
        <div class="col-auto w-100 mt-2">
            <textarea
              rows="5"
              matInput
              placeholder="Describe this moment"
              formControlName="description"
            >
            </textarea>
          <app-vmessage
            *ngIf="photoForm.get('description').errors?.maxlength"
            text="Máximo 300 caracteres"></app-vmessage>
        </div>
        <div class="col-auto w-100 mt-2 border-top">
          <input formControlName="file"
                 #fileInput
                 hidden
                 type="file"
                 accept="image/*"
                 (change)="fileChangeEvent( $event )"
          >
          <div class="cursor-pointer ml-1" (click)="fileInput.click()">
            <i class="mt-3 fa fa-camera-retro text-muted icons-footer" aria-hidden="true"></i>
            <span class="ml-2 text-muted font-weight-bold">Image</span>
          </div>
          <span class="ml-1 text-danger error-validate"
               *ngIf="photoForm.get('file').errors?.required; else showPreview">
            Insert at image
          </span>
        </div>
        <div class="col-auto w-100 mt-1">
          <ng-template #showPreview>
            <div class="text-center " appDarkenOnHover brightness="70%">
              <i class="fa fa-times pb-2 text-danger cursor-pointer mr-2 fa-3x" (click)="removeFile()"></i>
              <image-cropper
                class="preview"
                [imageChangedEvent]="imageChangedEvent"
                [maintainAspectRatio]="true"
                [aspectRatio]="3/4"
                (imageCropped)="imageCropped($event)"
                (cropperReady)="cropperReady()"
                (loadImageFailed)="loadImageFailed()"
              ></image-cropper>
            </div>
          </ng-template>
        </div>
        <div class="col-auto m-auto w-100 pt-4 pb-4">
          <button [disabled]="photoForm.invalid || blockSubmit"
                  type="submit"
                  class="cursor-pointer btn button-alert m-auto w-100">
            <span>Publish</span>
            <i class="fa fa-paper-plane" aria-hidden="true"></i>
          </button>
        </div>
        <div class="col">
          <ng-template  *ngIf="progress">
            <div class="text-center text-muted">
              <span>Progress {{progress}} %</span>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </form>
</div>
