<div class="container-photo-form">
  <form class="pb-4" [formGroup]="photoForm" (submit)="upload()">
    <div>
      <div class="row">
        <div class="col-auto w-50">
          <div *ngIf="!progress; else toProgress">
            <input type="checkbox" [checked]="allowComments" class="hide">
            <input type="checkbox" [checked]="public" class="hide">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-auto">
          <img [src]="avatar" class="avatar rounded-circle" onerror="this.src='https://be.mycircle.click/storage/profile_default/default.png'">
        </div>
        <div class="col-auto">
          <div class="mt-2 menu-options-public" (click)="public = !public">
            <span class="ml-2">Public</span>
            <i class="m-1 fa fa-globe {{public?'text-primary':'text-black'}}" aria-hidden="true" title="Público"></i>
          </div>
        </div>
        <div class="col-auto">
          <div class="mt-2 menu-options-public" (click)="allowComments = !allowComments">
            <span class="ml-1">Comment</span>
            <i class="m-1 fa fa-comments-o {{allowComments?'text-primary':'text-black'}}" aria-hidden="true"
               title="Ativar comentários"></i>
          </div>
        </div>
      </div>
      <div class="row w-100 m-auto">
        <div class="col-auto w-100 mt-2">
            <textarea
              rows="5"
              cols="100"
              matInput
              placeholder="Describe this moment"
              formControlName="description"
            >
            </textarea>
          <app-vmessage
            *ngIf="photoForm.get('description').errors?.maxlength"
            text="Máximo 300 caracteres"></app-vmessage>
        </div>
        <div class="col-auto w-100 mt-2 border-top">
          <input formControlName="file"
                 #fileInput
                 hidden
                 type="file"
                 accept="image/*"
                 (change)="handleFile( $event.target.files[0] )"
          >
          <div class="cursor-pointer ml-1" (click)="fileInput.click()">
            <i class="mt-3 fa fa-camera-retro text-muted icons-footer" aria-hidden="true"></i>
            <span class="ml-2 text-muted font-weight-bold">Image</span>
          </div>
          <span class="ml-1 text-danger error-validate"
               *ngIf="photoForm.get('file').errors?.required && !preview; else showPreview">
            Insert at image
          </span>
        </div>
        <div class="col-auto w-100 mt-1">
          <ng-template #showPreview>
            <div class="text-center " appDarkenOnHover brightness="70%">
              <i class="fa fa-times pb-2 text-danger cursor-pointer mr-2" (click)="removeFile()"></i>
              <img [src]="preview" title="Preview photo circle" class="mt-lg-5 preview" >
            </div>
          </ng-template>
        </div>
        <div class="col-auto m-auto w-100 pt-4">
          <button [disabled]="photoForm.invalid"
                  type="submit"
                  class="cursor-pointer btn btn-primary m-auto w-100">
            <span>Publish</span>
            <i class="fa fa-paper-plane" aria-hidden="true"></i>
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <ng-template #toProgress>
        <div class="text-center text-muted">
          <span>Progresso {{progress}} %</span>
        </div>
      </ng-template>
    </div>
  </form>
</div>
