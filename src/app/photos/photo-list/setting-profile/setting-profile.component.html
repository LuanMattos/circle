<form #form="ngForm" [formGroup]="settingForm" (submit)="save()"  autocomplete="off">
  <div class="container">
    <image-cropper
      [imageChangedEvent]="imageChangedEvent"
      [maintainAspectRatio]="true"
      [aspectRatio]="4/3"
      format="png"
      (imageCropped)="imageCropped($event)"
      (cropperReady)="cropperReady()"
      (loadImageFailed)="loadImageFailed()"
      *ngIf="croppedImage.length"
    ></image-cropper>
    <div class="container m-auto" *ngIf="croppedImage.length">
      <i class="fa fa-times fa-4x text-danger cursor-pointer text-left" aria-hidden="true" (click)="croppedImage = '';"></i>
      <i class="fa fa-check fa-4x {{stopClick?'text-muted':'text-info'}} cursor-pointer text-right float-right  mr-0" aria-hidden="true" (click)="getImageCropped();stopClick = true;"></i>
    </div>
    <div class="container-cover cursor-pointer" (click)="fileInputCover.click()">
      <img class="e2e-iframe-trusted-src cursor-pointer"
           [src]="user.user_cover_url"
           alt="Img"
           onerror="this.src='https://be.mycircle.click/storage/profile_default/default.png'"
      >
    </div>
    <img class="avatar rounded-circle e2e-iframe-trusted-src cursor-pointer"
         (click)="fileInput.click();"
         [src]="croppedImage.length?croppedImage:user.user_avatar_url"
         alt="Img">
    <input type="file" class="hide" formControlName="file" accept="image/*" (change)="fileChangeEvent( $event )" #fileInput>
    <input type="file" class="hide" formControlName="file" accept="image/*" (change)="uploadCover( $event.target.files[0] )" #fileInputCover>

    <div class="form-group">
      <mat-form-field class="w-100">
        <mat-label>E-mail</mat-label>
        <input #inputEmail matInput placeholder="E-mail" autofocus formControlName="userEmail">
      </mat-form-field>
      <app-vmessage *ngIf="settingForm.get('userEmail').errors?.required" text="E-mail is required!"></app-vmessage>
      <app-vmessage *ngIf="settingForm.get('userEmail').errors?.email" text="Invalid email!"></app-vmessage>
    </div>
    <div class="form-group">
      <mat-form-field class="w-100">
        <mat-label>Change Password</mat-label>
        <input matInput [type]="hidePass ? 'password' : 'text'" placeholder="Change password" autofocus formControlName="userPasswordChange">
        <button type="button" mat-icon-button matSuffix (click)="hidePass = !hidePass" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hidePass">
          <i class='fa fa-low-vision' (click)="hidePass ? 'fa-low-vision' : 'visibility'"></i>
        </button>
      </mat-form-field>
      <app-vmessage *ngIf="settingForm.get('userPassword').errors?.minlength"
                    text="Min 8 character!"></app-vmessage>
    </div>
    <div class="form-group">
      <mat-form-field class="w-100">
        <mat-label>Current password</mat-label>
        <input matInput [type]="hidePass ? 'password' : 'text'" placeholder="Current password"  formControlName="userPassword" >
        <button type="button" mat-icon-button matSuffix (click)="hidePass = !hidePass" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hidePass">
          <i class='fa fa-low-vision' (click)="hidePass ? 'fa-low-vision' : 'visibility'"></i>
        </button>
      </mat-form-field>
      <app-vmessage *ngIf="settingForm.get('userPassword').errors?.message"
                    text="Password incorrect"></app-vmessage>
      <app-vmessage *ngIf="settingForm.get('userPassword').errors?.required"
                    text="Password is required!"></app-vmessage>
      <app-vmessage *ngIf="settingForm.get('userPassword').errors?.minlength"
                    text="Min 8 character!"></app-vmessage>

    </div>
    <div class="form-group">
      <mat-form-field class="w-100">
        <mat-label>Live in</mat-label>
        <input matInput placeholder="Live in"  formControlName="userAddress">
      </mat-form-field>
    </div>
    <div class="form-group">
      <div class="col-auto w-100 m-auto">
        <textarea matInput placeholder="About me" autofocus formControlName="userDescription"></textarea>
      </div>
    </div>
    <button  class="w-100 bg-dark text-white" [disabled]="this.settingForm.invalid && !this.settingForm.pending" mat-raised-button>Change</button>
  </div>
</form>


